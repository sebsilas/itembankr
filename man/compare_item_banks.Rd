% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compare_item_banks.R
\name{compare_item_banks}
\alias{compare_item_banks}
\title{Compare two item banks (music corpora) by feature distributions and components}
\usage{
compare_item_banks(
  item_bank1,
  item_bank2,
  item_bank_names = c("Bank A", "Bank B"),
  include = NULL,
  exclude = "ngrukkon",
  id_cols = c("item_id", "parent_durations", "parent_abs_melody"),
  standardise = TRUE,
  pa_type = c("pc", "fa"),
  max_plots = 36,
  seed = 123,
  verbose = TRUE,
  rotate = c("none", "varimax", "promax", "oblimin", "equamax"),
  name_top = 2
)
}
\arguments{
\item{item_bank1, item_bank2}{Data frames with (mostly) numeric feature columns.}

\item{item_bank_names}{Character length-2 naming the banks.}

\item{include, exclude}{Optional tidyselect/character to filter features.}

\item{id_cols}{Character of columns to exclude from features.}

\item{standardise}{Logical; scale/center features before PCA/PA.}

\item{pa_type}{"pc" or "fa" for how many dimensions to retain from PA.}

\item{max_plots}{Cap the number of violin facets.}

\item{seed}{RNG seed for reproducibility.}

\item{verbose}{Print CLI progress/tables.}

\item{rotate}{Rotation method passed to psych::principal(): One of "none", "varimax", "promax", "oblimin", "equamax" (default: "none").}

\item{name_top}{Integer; how many top-loading features to include in each component's label (default 2).}
}
\value{
A list with tibbles, ggplots, and PA/PCA objects.
}
\description{
Compare two item banks (music corpora) by feature distributions and components
}
\examples{
set.seed(123)


res <- compare_item_banks(
  item_bank1  = WJD::phrase_item_bank,
  item_bank2  = Berkowitz::phrase_item_bank,
  item_bank_names  = c("WJD", "Berkowitz"),
  standardise = TRUE,
  pa_type     = "pc",
  rotate      = "varimax",
  name_top    = 2,
  verbose     = FALSE
)

# --- Numeric summaries & differences ---
head(res$descriptives)
res$differences |>
  dplyr::arrange(dplyr::desc(abs(cohen_d))) |>
  dplyr::slice_head(n = 5)

# --- PCA outputs ---
# Named loadings (top-loadings in column names)
colnames(res$pca$joint$rotation)
# Score summaries by bank
res$pca$joint_score_summary

# --- Categorical outputs ---
# Long rows (feature, .bank, level)
res$categoricals$long |> dplyr::distinct(feature) |> dplyr::arrange(feature)
# Tests per feature (chi-square/Fisher, CramÃ©r's V, JS divergence)
res$categoricals$tests |>
  dplyr::arrange(dplyr::desc(cramers_v)) |>
  dplyr::slice_head(n = 5)
# Per-bank, per-level proportions
res$categoricals$proportions |> dplyr::slice_head(n = 10)

# --- Plots (not run on CRAN) ---
\donttest{
  res$violin_plot
  res$categoricals$plot
  res$pca$joint_density_plot
}


}
